  [1m[35m (292.7ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (4.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (1.8ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2022-02-09 19:11:21.592125"], ["updated_at", "2022-02-09 19:11:21.592125"]]
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to DeviseTokenAuthCreateUsers (20211029160155)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "provider" character varying DEFAULT 'email' NOT NULL, "uid" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp, "allow_password_change" boolean DEFAULT FALSE, "remember_created_at" timestamp, "confirmation_token" character varying, "confirmed_at" timestamp, "confirmation_sent_at" timestamp, "unconfirmed_email" character varying, "name" character varying, "image" character varying, "email" character varying NOT NULL, "phone_number" character varying, "phone_number_verified" boolean DEFAULT FALSE NOT NULL, "role" integer DEFAULT 0 NOT NULL, "status" integer DEFAULT 0 NOT NULL, "tokens" json, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (6.0ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_email" ON "users"  ("email")[0m
  [1m[35m (2.5ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_uid_and_provider" ON "users"  ("uid", "provider")[0m
  [1m[35m (5.7ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_reset_password_token" ON "users"  ("reset_password_token")[0m
  [1m[35m (6.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_confirmation_token" ON "users"  ("confirmation_token")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20211029160155"]]
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" LIMIT $1[0m  [["LIMIT", 11]]
  [1m[35m (3.2ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (2.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.6ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:04:05 +0000
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::RegistrationsController#create as */*
Filter chain halted as :validate_sign_up_params rendered or redirected
Completed 422 Unprocessable Entity in 508ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 15136)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:04:51 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "registration"=>{"email"=>"test@test.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (3.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 742ms (Views: 2.1ms | ActiveRecord: 19.5ms | Allocations: 20358)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:05:27 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"phone_number"=>"01231231231", "password"=>"[FILTERED]", "registration"=>{"phone_number"=>"01231231231", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" IS NULL AND "users"."provider" = $1 LIMIT $2[0m  [["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 328ms (Views: 0.4ms | ActiveRecord: 1.3ms | Allocations: 5941)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:06:14 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "phone_number"=>"01231231231", "name"=>"test user 1", "registration"=>{"email"=>"test@test.com", "password"=>"[FILTERED]", "phone_number"=>"01231231231", "name"=>"test user 1"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (4.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "test@test.com"], ["encrypted_password", "$2a$12$LJWxk/TzUhKbxnpNjgiIZ.l1tZDv9I3eQhgy5JeYhf1h0MbvNNAIi"], ["name", "test user 1"], ["email", "test@test.com"], ["phone_number", "01231231231"], ["created_at", "2022-02-10 17:06:15.261095"], ["updated_at", "2022-02-10 17:06:15.261095"]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
uninitialized constant #<Class:0x000055ea33382e80>::Consumer
/src/app/app/models/user.rb:61:in `create_consumer'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:428:in `block in make_lambda'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:263:in `block in conditional'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:517:in `block in invoke_after'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:517:in `each'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:517:in `invoke_after'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:136:in `run_callbacks'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:825:in `_run_commit_callbacks'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:339:in `committed!'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/transaction.rb:127:in `commit_records'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/transaction.rb:265:in `block in commit_transaction'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:26:in `block (2 levels) in synchronize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `handle_interrupt'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `block in synchronize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `handle_interrupt'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `synchronize'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/transaction.rb:255:in `commit_transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/transaction.rb:293:in `block in within_new_transaction'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:26:in `block (2 levels) in synchronize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `handle_interrupt'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `block in synchronize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `handle_interrupt'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `synchronize'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/transaction.rb:278:in `within_new_transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/database_statements.rb:280:in `transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:212:in `transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:366:in `with_transaction_returning_status'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:314:in `save'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/suppressor.rb:44:in `save'
/src/bundle/gems/devise_token_auth-1.2.0/app/controllers/devise_token_auth/registrations_controller.rb:43:in `create'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/mapper.rb:18:in `block in <class:Constraints>'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/mapper.rb:48:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 671ms (Views: 0.3ms | ActiveRecord: 7.1ms | Allocations: 9840)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:08:51 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "phone_number"=>"01231231231", "name"=>"test user 1", "registration"=>{"email"=>"test@test.com", "password"=>"[FILTERED]", "phone_number"=>"01231231231", "name"=>"test user 1"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 309ms (Views: 0.2ms | ActiveRecord: 7.5ms | Allocations: 17247)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:09:32 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "phone_number"=>"01231231231", "name"=>"test user 1", "registration"=>{"email"=>"test@test.com", "password"=>"[FILTERED]", "phone_number"=>"01231231231", "name"=>"test user 1"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (1.4ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 297ms (Views: 0.7ms | ActiveRecord: 9.0ms | Allocations: 17146)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 17:10:53 +0000
Processing by Api::V1::UsersController#show as */*
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 2ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 221)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:11:39 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"test2@test.com", "password"=>"[FILTERED]", "phone_number"=>"01231231231", "name"=>"test user 1", "registration"=>{"email"=>"test2@test.com", "password"=>"[FILTERED]", "phone_number"=>"01231231231", "name"=>"test user 1"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test2@test.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "test2@test.com"], ["encrypted_password", "$2a$12$aK3I5Vn6.Y8jkcOrsWj/euYtXCpNamK/uiwK83wCdD.90OzgIikBC"], ["name", "test user 1"], ["email", "test2@test.com"], ["phone_number", "01231231231"], ["created_at", "2022-02-10 17:11:39.365488"], ["updated_at", "2022-02-10 17:11:39.365488"]]
  [1m[35m (6.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (1.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.9ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"2UaZjLLowyzfei5J4vdM7w\\\":{\\\"token\\\":\\\"$2a$10$r.oAXcuCcx4MX7W54hf1aOaUuSuWyiLCK4t5AtBY9wEe5QpLwOStS\\\",\\\"expiry\\\":1645722699}}\""], ["updated_at", "2022-02-10 17:11:39.453938"], ["id", 2]]
  [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
Completed 200 OK in 434ms (Views: 0.2ms | ActiveRecord: 17.3ms | Allocations: 12189)


Started POST "/api/v1/auth/login" for 172.25.0.1 at 2022-02-10 17:12:17 +0000
  
ActionController::RoutingError (No route matches [POST] "/api/v1/auth/login"):
  
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:36:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-10 17:13:16 +0000
Processing by DeviseTokenAuth::SessionsController#create as */*
Completed 401 Unauthorized in 2ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 299)


Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-10 17:13:46 +0000
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "session"=>{"email"=>"test@test.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (1.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"Mpkhe9ZNHnQ2CmSIouDFSw\\\":{\\\"token\\\":\\\"$2a$10$ChpfKg5XsIelq/3LyqoPqOsgIEVkwQjj2MLZdmYoAQZnqD/RMj5du\\\",\\\"expiry\\\":1645722826}}\""], ["updated_at", "2022-02-10 17:13:46.678308"], ["id", 1]]
  [1m[35m (3.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 390ms (Views: 0.3ms | ActiveRecord: 6.2ms | Allocations: 7401)


Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-10 17:20:32 +0000
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "session"=>{"email"=>"test@test.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (1.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"Mpkhe9ZNHnQ2CmSIouDFSw\\\":{\\\"token\\\":\\\"$2a$10$ChpfKg5XsIelq/3LyqoPqOsgIEVkwQjj2MLZdmYoAQZnqD/RMj5du\\\",\\\"expiry\\\":1645722826},\\\"qkEQtVwpAcx1E1-gH4-omg\\\":{\\\"token\\\":\\\"$2a$10$oa0O.xW9t0RJHszH9yDfmeRWwVQq7sHyspPIoTFXPumdEPhd1spCi\\\",\\\"expiry\\\":1645723232}}\""], ["updated_at", "2022-02-10 17:20:32.793360"], ["id", 1]]
  [1m[35m (4.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 358ms (Views: 0.7ms | ActiveRecord: 8.4ms | Allocations: 7523)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 17:21:48 +0000
Processing by Api::V1::UsersController#show as */*
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 5ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 152)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 17:24:03 +0000
Processing by Api::V1::UsersController#show as */*
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 11ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 153)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 17:25:32 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "test@test.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 7.3ms | Allocations: 139)
  Rendered api/v1/users/show.json.jbuilder (Duration: 170.3ms | Allocations: 775)
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 368ms (Views: 226.3ms | ActiveRecord: 2.7ms | Allocations: 6387)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:27:16 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"player1@derby.com", "phone_number"=>"01231231232", "password"=>"[FILTERED]", "name"=>"player 1", "registration"=>{"email"=>"player1@derby.com", "phone_number"=>"01231231232", "password"=>"[FILTERED]", "name"=>"player 1"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "player1@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "player1@derby.com"], ["encrypted_password", "$2a$12$b0pfKbT429eybrO06qz5vewVf3f4uXJnvv2R7PPZBtpEVsO1JJOgq"], ["name", "player 1"], ["email", "player1@derby.com"], ["phone_number", "01231231232"], ["created_at", "2022-02-10 17:27:16.620238"], ["updated_at", "2022-02-10 17:27:16.620238"]]
  [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"DfcMOXUTu6t8mR1tEF9Kgw\\\":{\\\"token\\\":\\\"$2a$10$W2fsHXYMp/J3I1K/A/oiAOfJh7mA7BvyyVQpjc89Q4fBddu.WpSJS\\\",\\\"expiry\\\":1645723636}}\""], ["updated_at", "2022-02-10 17:27:16.699437"], ["id", 3]]
  [1m[35m (3.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 365ms (Views: 0.5ms | ActiveRecord: 13.0ms | Allocations: 11790)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:27:35 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"referee1@derby.com", "phone_number"=>"01231231233", "password"=>"[FILTERED]", "name"=>"referee 1", "registration"=>{"email"=>"referee1@derby.com", "phone_number"=>"01231231233", "password"=>"[FILTERED]", "name"=>"referee 1"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "referee1@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "referee1@derby.com"], ["encrypted_password", "$2a$12$9HRnoZUAicdBSIsVgCJSeul5XH7NyNHmsH8f7akp9NRew3oRUHgDi"], ["name", "referee 1"], ["email", "referee1@derby.com"], ["phone_number", "01231231233"], ["created_at", "2022-02-10 17:27:36.032943"], ["updated_at", "2022-02-10 17:27:36.032943"]]
  [1m[35m (6.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"ghBx-7mwGQSQ9ldH0ORKHw\\\":{\\\"token\\\":\\\"$2a$10$u9PVAUf2OVOZESwMxLPuHuaDrd.nMYOvi9s9yiUfBOkyws/a.6TUm\\\",\\\"expiry\\\":1645723656}}\""], ["updated_at", "2022-02-10 17:27:36.114421"], ["id", 4]]
  [1m[35m (5.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
Completed 200 OK in 369ms (Views: 0.2ms | ActiveRecord: 15.0ms | Allocations: 11855)


  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "role" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["role", 1], ["updated_at", "2022-02-10 17:28:04.040792"], ["id", 4]]
  [1m[35m (3.6ms)[0m  [1m[35mCOMMIT[0m
Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:28:31 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"referee2@derby.com", "phone_number"=>"01231231234", "password"=>"[FILTERED]", "name"=>"referee 2", "role"=>"referee", "registration"=>{"email"=>"referee2@derby.com", "phone_number"=>"01231231234", "password"=>"[FILTERED]", "name"=>"referee 2", "role"=>"referee"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "referee2@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "referee2@derby.com"], ["encrypted_password", "$2a$12$icc4T/tHXneoyPzvf6k/tevxTqo8NGsrT8nF2cQdYg567QYfHfxJy"], ["name", "referee 2"], ["email", "referee2@derby.com"], ["phone_number", "01231231234"], ["role", 1], ["created_at", "2022-02-10 17:28:31.672219"], ["updated_at", "2022-02-10 17:28:31.672219"]]
  [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"-a_NpT1a5VLYXvF_XoOukQ\\\":{\\\"token\\\":\\\"$2a$10$k0Vm..IhknJhpwYyuyWsouxI3hfwW1t79km.nNx/ghNTzY3GWaXOy\\\",\\\"expiry\\\":1645723711}}\""], ["updated_at", "2022-02-10 17:28:31.753514"], ["id", 5]]
  [1m[35m (3.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
Completed 200 OK in 403ms (Views: 0.3ms | ActiveRecord: 10.7ms | Allocations: 11893)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 17:28:40 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "referee2@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 0.5ms | Allocations: 47)
  Rendered api/v1/users/show.json.jbuilder (Duration: 26.6ms | Allocations: 233)
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
Completed 200 OK in 135ms (Views: 39.7ms | ActiveRecord: 1.4ms | Allocations: 3022)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:39:06 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"referee2@derby.com", "phone_number"=>"01231231234", "password"=>"[FILTERED]", "name"=>"referee 2", "role"=>"referee", "registration"=>{"email"=>"referee2@derby.com", "phone_number"=>"01231231234", "password"=>"[FILTERED]", "name"=>"referee 2", "role"=>"referee"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "referee2@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 366ms (Views: 5.0ms | ActiveRecord: 5.7ms | Allocations: 16741)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:39:20 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"referee3@derby.com", "phone_number"=>"01231231235", "password"=>"[FILTERED]", "name"=>"referee 3", "role"=>"referee", "registration"=>{"email"=>"referee3@derby.com", "phone_number"=>"01231231235", "password"=>"[FILTERED]", "name"=>"referee 3", "role"=>"referee"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "referee3@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "referee3@derby.com"], ["encrypted_password", "$2a$12$lVTJS4TDgw5NKgkrVrjtUea3xoZoLGqFAQK9gPTvdDjj56FvxpkDi"], ["name", "referee 3"], ["email", "referee3@derby.com"], ["phone_number", "01231231235"], ["role", 1], ["created_at", "2022-02-10 17:39:20.832815"], ["updated_at", "2022-02-10 17:39:20.832815"]]
  [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"Dm-R9F9N7NSHGhN5_JTFvA\\\":{\\\"token\\\":\\\"$2a$10$2J/i5jy4wYIMikr8Hx0wPO9t8z..daNkj6tQmSHo0Gje4pPfUQaJe\\\",\\\"expiry\\\":1645724360}}\""], ["updated_at", "2022-02-10 17:39:20.951014"], ["id", 6]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (4.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
Completed 200 OK in 483ms (Views: 0.3ms | ActiveRecord: 17.7ms | Allocations: 12167)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:41:30 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"referee3@derby.com", "phone_number"=>"01231231235", "password"=>"[FILTERED]", "name"=>"referee 3", "role"=>"referee", "registration"=>{"email"=>"referee3@derby.com", "phone_number"=>"01231231235", "password"=>"[FILTERED]", "name"=>"referee 3", "role"=>"referee"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "referee3@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "01231231235"], ["LIMIT", 1]]
  [1m[35m (1.4ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 473ms (Views: 0.3ms | ActiveRecord: 11.1ms | Allocations: 19142)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:41:51 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"referee4@derby.com", "phone_number"=>"01231231236", "password"=>"[FILTERED]", "name"=>"referee 4", "role"=>"referee", "registration"=>{"email"=>"referee4@derby.com", "phone_number"=>"01231231236", "password"=>"[FILTERED]", "name"=>"referee 4", "role"=>"referee"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "referee4@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "01231231236"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "referee4@derby.com"], ["encrypted_password", "$2a$12$gDOHV8e1.igX/izvQHflQ.lJEFQOI2UNVZh8tT42LYPzHKxPaASfO"], ["name", "referee 4"], ["email", "referee4@derby.com"], ["phone_number", "01231231236"], ["role", 1], ["created_at", "2022-02-10 17:41:52.201860"], ["updated_at", "2022-02-10 17:41:52.201860"]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (1.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231236"], ["id", 7], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"tqvDWVxLmGg8gc4dx1NDdQ\\\":{\\\"token\\\":\\\"$2a$10$kLw/2TtK.ij2SvyuERoipucXTxIOApf2CE5DGDUzae8Yk3ZRva2De\\\",\\\"expiry\\\":1645724512}}\""], ["updated_at", "2022-02-10 17:41:52.288920"], ["id", 7]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
Completed 200 OK in 378ms (Views: 0.2ms | ActiveRecord: 12.3ms | Allocations: 15131)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-10 17:43:46 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"refere5@derby.com", "phone_number"=>"01231231237", "password"=>"[FILTERED]", "name"=>"referee5", "role"=>"referee", "registration"=>{"email"=>"refere5@derby.com", "phone_number"=>"01231231237", "password"=>"[FILTERED]", "name"=>"referee5", "role"=>"referee"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "refere5@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "01231231237"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "role", "status", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["uid", "refere5@derby.com"], ["encrypted_password", "$2a$12$n0AXglcAXLiZfqYrzEZWSeBSO.ea/kTL0i3lYy1expyeyca6pWr/6"], ["name", "referee5"], ["email", "refere5@derby.com"], ["phone_number", "01231231237"], ["role", 1], ["status", 1], ["created_at", "2022-02-10 17:43:46.631091"], ["updated_at", "2022-02-10 17:43:46.631091"]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231237"], ["id", 8], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"TEG8jJz7LuafnsDb7CVpNQ\\\":{\\\"token\\\":\\\"$2a$10$3puju15HaiMckXPOh9BogORjD0Kzaa5EXWDH37plJGcN4CJm91RWG\\\",\\\"expiry\\\":1645724626}}\""], ["updated_at", "2022-02-10 17:43:46.739044"], ["id", 8]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (6.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
Completed 200 OK in 452ms (Views: 13.1ms | ActiveRecord: 20.9ms | Allocations: 26714)


  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateTeams (20220210175110)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (29.2ms)[0m  [1m[35mCREATE TABLE "teams" ("id" bigserial primary key, "name" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220210175110"]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddTeamToUser (20220210175721)
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "users" ADD "team_id" bigint[0m
  [1m[35m (5.7ms)[0m  [1m[35mCREATE  INDEX  "index_users_on_team_id" ON "users"  ("team_id")[0m
  [1m[35m (6.0ms)[0m  [1m[35mALTER TABLE "users" ADD CONSTRAINT "fk_rails_b2bbf87303"
FOREIGN KEY ("team_id")
  REFERENCES "teams" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220210175721"]]
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-10 18:00:44 +0000
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "session"=>{"email"=>"test@test.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (2.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231231"], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 398ms (Views: 0.5ms | ActiveRecord: 5.0ms | Allocations: 19324)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 18:00:50 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "null"], ["LIMIT", 1]]
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 33ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 1398)


Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-10 18:00:57 +0000
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "session"=>{"email"=>"test@test.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231231"], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 331ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 7824)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 18:01:03 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "null"], ["LIMIT", 1]]
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 10ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 1219)


Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-10 18:02:04 +0000
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"test@test.com", "password"=>"[FILTERED]", "session"=>{"email"=>"test@test.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "test@test.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231231"], ["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 341ms (Views: 0.4ms | ActiveRecord: 2.8ms | Allocations: 7823)


Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-10 18:02:47 +0000
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"player1@derby.com", "password"=>"[FILTERED]", "session"=>{"email"=>"player1@derby.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "player1@derby.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231232"], ["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (1.8ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"DfcMOXUTu6t8mR1tEF9Kgw\\\":{\\\"token\\\":\\\"$2a$10$W2fsHXYMp/J3I1K/A/oiAOfJh7mA7BvyyVQpjc89Q4fBddu.WpSJS\\\",\\\"expiry\\\":1645723636},\\\"bUZLzK9z8g0Y67EGB3OdPQ\\\":{\\\"token\\\":\\\"$2a$10$CqO6Gy6feuYOQIQ/TQzK8OCO.8J66KEIuLUEb3b7QQsk9F7HJy71m\\\",\\\"expiry\\\":1645725767}}\""], ["updated_at", "2022-02-10 18:02:47.708717"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 355ms (Views: 0.2ms | ActiveRecord: 6.7ms | Allocations: 9128)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 18:02:54 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 62.5ms | Allocations: 2799)
  Rendered api/v1/users/show.json.jbuilder (Duration: 66.1ms | Allocations: 3220)
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 158ms (Views: 69.5ms | ActiveRecord: 0.9ms | Allocations: 6367)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 18:03:22 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 5.4ms | Allocations: 130)
  Rendered api/v1/users/show.json.jbuilder (Duration: 13.4ms | Allocations: 556)
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 43ms (Views: 26.0ms | ActiveRecord: 2.0ms | Allocations: 3669)


  [1m[35m (0.8ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.9ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (2.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 18:19:17 +0000
  [1m[35m (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
unable to find policy `UserPolicy` for `User(id: integer, provider: string, uid: string, encrypted_password: string, reset_password_token: string, reset_password_sent_at: datetime, allow_password_change: boolean, remember_created_at: datetime, confirmation_token: string, confirmed_at: datetime, confirmation_sent_at: datetime, unconfirmed_email: string, name: string, image: string, email: string, phone_number: string, phone_number_verified: boolean, role: integer, status: integer, tokens: json, created_at: datetime, updated_at: datetime, team_id: integer)`
/src/bundle/gems/pundit-2.1.1/lib/pundit/policy_finder.rb:54:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:141:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:261:in `policy'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:221:in `authorize'
/src/app/app/controllers/api/v1/users_controller.rb:8:in `show'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 1017ms (Views: 0.2ms | ActiveRecord: 12.7ms | Allocations: 30817)


  [1m[35m (2.5ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-10 18:20:09 +0000
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 40.3ms | Allocations: 1585)
  Rendered api/v1/users/show.json.jbuilder (Duration: 59.2ms | Allocations: 2231)
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 298ms (Views: 102.8ms | ActiveRecord: 8.0ms | Allocations: 21020)


  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddCaptainToTeam (20220210182341)
  [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "teams" ADD "captain_id" bigint NOT NULL[0m
  [1m[35m (4.0ms)[0m  [1m[35mCREATE  INDEX  "index_teams_on_captain_id" ON "teams"  ("captain_id")[0m
  [1m[35m (4.9ms)[0m  [1m[35mALTER TABLE "teams" ADD CONSTRAINT "fk_rails_ecb2d22ad1"
FOREIGN KEY ("captain_id")
  REFERENCES "users" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (3.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220210182341"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/api/v1/teams" for 172.25.0.1 at 2022-02-10 19:18:15 +0000
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Api::V1::TeamsController#index as */*
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "teams"[0m
  ↳ app/controllers/application_controller.rb:24:in `paginate'
  Rendering api/v1/teams/index.json.jbuilder
  [1m[36mTeam Load (0.5ms)[0m  [1m[34mSELECT "teams".* FROM "teams" LIMIT $1 OFFSET $2[0m  [["LIMIT", 10], ["OFFSET", 0]]
  ↳ app/views/api/v1/teams/index.json.jbuilder:2
  Rendered collection of api/v1/teams/_minimal.json.jbuilder [0 times] (Duration: 0.0ms | Allocations: 3)
  Rendered api/v1/teams/index.json.jbuilder (Duration: 26.9ms | Allocations: 1083)
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 278ms (Views: 31.3ms | ActiveRecord: 5.8ms | Allocations: 19679)


Started POST "/api/v1/teams" for 172.25.0.1 at 2022-02-10 19:19:04 +0000
Processing by Api::V1::TeamsController#create as */*
  Parameters: {"team"=>{"name"=>"Test Team 1"}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:20:in `block in create'
  [1m[36mTeam Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 LIMIT $2[0m  [["name", "Test Team 1"], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mTeam Create (2.1ms)[0m  [1m[32mINSERT INTO "teams" ("name", "created_at", "updated_at", "captain_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Test Team 1"], ["created_at", "2022-02-10 19:19:04.171597"], ["updated_at", "2022-02-10 19:19:04.171597"], ["captain_id", 3]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mUser Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231232"], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:23:in `block in create'
  [1m[36mUser Update (1.8ms)[0m  [1m[33mUPDATE "users" SET "team_id" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["team_id", 1], ["updated_at", "2022-02-10 19:19:04.193496"], ["id", 3]]
  ↳ app/controllers/api/v1/teams_controller.rb:23:in `block in create'
  [1m[35m (4.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/teams_controller.rb:19:in `create'
  Rendering api/v1/teams/create.json.jbuilder
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:3
  Rendered api/v1/users/_minimal.json.jbuilder (Duration: 5.7ms | Allocations: 89)
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:8
  Rendered collection of api/v1/users/_minimal.json.jbuilder [1 times] (Duration: 2.3ms | Allocations: 117)
  Rendered api/v1/teams/_team.json.jbuilder (Duration: 117.0ms | Allocations: 6461)
  Rendered api/v1/teams/create.json.jbuilder (Duration: 126.3ms | Allocations: 6977)
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 210ms (Views: 128.3ms | ActiveRecord: 16.6ms | Allocations: 18273)


Started GET "/api/v1/teams" for 172.25.0.1 at 2022-02-10 19:19:16 +0000
Processing by Api::V1::TeamsController#index as */*
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "teams"[0m
  ↳ app/controllers/application_controller.rb:24:in `paginate'
  Rendering api/v1/teams/index.json.jbuilder
  [1m[36mTeam Load (0.5ms)[0m  [1m[34mSELECT "teams".* FROM "teams" LIMIT $1 OFFSET $2[0m  [["LIMIT", 10], ["OFFSET", 0]]
  ↳ app/views/api/v1/teams/index.json.jbuilder:2
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_minimal.json.jbuilder:3
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/views/api/v1/teams/_minimal.json.jbuilder:6
  Rendered collection of api/v1/teams/_minimal.json.jbuilder [1 times] (Duration: 26.6ms | Allocations: 1981)
  Rendered api/v1/teams/index.json.jbuilder (Duration: 44.1ms | Allocations: 2918)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 74ms (Views: 51.1ms | ActiveRecord: 3.4ms | Allocations: 6569)


Started GET "/api/v1/teams/1" for 172.25.0.1 at 2022-02-10 19:19:36 +0000
Processing by Api::V1::TeamsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
undefined local variable or method `parms' for #<Api::V1::TeamsController:0x00007f99100160c0>
Did you mean?  params
               params=
/src/app/app/controllers/api/v1/teams_controller.rb:39:in `set_team'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:428:in `block in make_lambda'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:181:in `block (2 levels) in halting_and_conditional'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:182:in `block in halting_and_conditional'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:513:in `block in invoke_before'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:513:in `each'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:513:in `invoke_before'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:134:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 589ms (Views: 0.3ms | ActiveRecord: 1.4ms | Allocations: 139637)


Started GET "/api/v1/teams/1" for 172.25.0.1 at 2022-02-10 19:20:16 +0000
Processing by Api::V1::TeamsController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mTeam Load (0.4ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:39:in `set_team'
  Rendering api/v1/teams/show.json.jbuilder
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:3
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:5
  Rendered api/v1/users/_minimal.json.jbuilder (Duration: 0.3ms | Allocations: 34)
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:8
  Rendered collection of api/v1/users/_minimal.json.jbuilder [1 times] (Duration: 0.1ms | Allocations: 45)
  Rendered api/v1/teams/_team.json.jbuilder (Duration: 33.5ms | Allocations: 3150)
  Rendered api/v1/teams/show.json.jbuilder (Duration: 41.2ms | Allocations: 3499)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 246ms (Views: 46.2ms | ActiveRecord: 11.2ms | Allocations: 23675)


Started PUT "/api/v1/teams/1" for 172.25.0.1 at 2022-02-10 19:21:04 +0000
Processing by Api::V1::TeamsController#update as */*
  Parameters: {"team"=>{"name"=>"updated name"}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mTeam Load (0.3ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:39:in `set_team'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[36mTeam Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 AND "teams"."id" != $2 LIMIT $3[0m  [["name", "updated name"], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "users"."id" FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/models/team.rb:29:in `team_captain_is_member'
  [1m[36mTeam Update (0.4ms)[0m  [1m[33mUPDATE "teams" SET "name" = $1, "updated_at" = $2 WHERE "teams"."id" = $3[0m  [["name", "updated name"], ["updated_at", "2022-02-10 19:21:04.883510"], ["id", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  Rendering api/v1/teams/update.json.jbuilder
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:3
  Rendered api/v1/users/_minimal.json.jbuilder (Duration: 0.2ms | Allocations: 31)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:8
  Rendered collection of api/v1/users/_minimal.json.jbuilder [1 times] (Duration: 0.1ms | Allocations: 45)
  Rendered api/v1/teams/_team.json.jbuilder (Duration: 27.8ms | Allocations: 1937)
  Rendered api/v1/teams/update.json.jbuilder (Duration: 34.1ms | Allocations: 2285)
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 130ms (Views: 36.7ms | ActiveRecord: 9.1ms | Allocations: 11549)


Started PUT "/api/v1/teams/1" for 172.25.0.1 at 2022-02-10 19:21:27 +0000
Processing by Api::V1::TeamsController#update as */*
  Parameters: {"team"=>{"captain_id"=>4}, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mTeam Load (0.4ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:39:in `set_team'
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[36mTeam Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 AND "teams"."id" != $2 LIMIT $3[0m  [["name", "updated name"], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "users"."id" FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/models/team.rb:29:in `team_captain_is_member'
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
Completed 422 Unprocessable Entity in 67ms (Views: 0.3ms | ActiveRecord: 5.6ms | Allocations: 6861)


Started PUT "/api/v1/teams/1" for 172.25.0.1 at 2022-02-10 19:21:31 +0000
Processing by Api::V1::TeamsController#update as */*
  Parameters: {"team"=>{"captain_id"=>3}, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mTeam Load (0.3ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:39:in `set_team'
  [1m[35m (1.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[36mTeam Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 AND "teams"."id" != $2 LIMIT $3[0m  [["name", "updated name"], ["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "users"."id" FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/models/team.rb:29:in `team_captain_is_member'
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/teams_controller.rb:29:in `update'
  Rendering api/v1/teams/update.json.jbuilder
  [1m[35m (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:3
  Rendered api/v1/users/_minimal.json.jbuilder (Duration: 1.5ms | Allocations: 31)
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:8
  Rendered collection of api/v1/users/_minimal.json.jbuilder [1 times] (Duration: 0.3ms | Allocations: 45)
  Rendered api/v1/teams/_team.json.jbuilder (Duration: 35.2ms | Allocations: 1937)
  Rendered api/v1/teams/update.json.jbuilder (Duration: 53.3ms | Allocations: 2222)
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 158ms (Views: 53.1ms | ActiveRecord: 9.7ms | Allocations: 10293)


  [1m[35m (2.8ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (3.1ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-11 16:47:57 +0000
  [1m[35m (1.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"player1@derby.com", "password"=>"[FILTERED]", "session"=>{"email"=>"player1@derby.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (10.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "player1@derby.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231232"], ["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (2.0ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"DfcMOXUTu6t8mR1tEF9Kgw\\\":{\\\"token\\\":\\\"$2a$10$W2fsHXYMp/J3I1K/A/oiAOfJh7mA7BvyyVQpjc89Q4fBddu.WpSJS\\\",\\\"expiry\\\":1645723636},\\\"bUZLzK9z8g0Y67EGB3OdPQ\\\":{\\\"token\\\":\\\"$2a$10$CqO6Gy6feuYOQIQ/TQzK8OCO.8J66KEIuLUEb3b7QQsk9F7HJy71m\\\",\\\"expiry\\\":1645725767},\\\"NFApXlKLjSFY4B7UjW6Ghw\\\":{\\\"token\\\":\\\"$2a$10$jmkFOSl5qT.fA7V6prUmDOv16aHA4th6dCYSyQAE7YkQM7sRZgie6\\\",\\\"expiry\\\":1645807680}}\""], ["updated_at", "2022-02-11 16:48:00.754027"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 711ms (Views: 1.3ms | ActiveRecord: 26.5ms | Allocations: 23618)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-11 16:48:10 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  [1m[36mTeam Load (3.0ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/views/api/v1/users/_user.json.jbuilder:8
  Rendered api/v1/users/_user.json.jbuilder (Duration: 61.2ms | Allocations: 6045)
  Rendered api/v1/users/show.json.jbuilder (Duration: 78.1ms | Allocations: 6599)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 198ms (Views: 89.8ms | ActiveRecord: 8.6ms | Allocations: 10706)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-11 16:48:47 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  [1m[36mTeam Load (0.6ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/views/api/v1/users/_user.json.jbuilder:8
  Rendered api/v1/users/_user.json.jbuilder (Duration: 649.3ms | Allocations: 269510)
  Rendered api/v1/users/show.json.jbuilder (Duration: 660.1ms | Allocations: 269837)
undefined local variable or method `jsonn' for #<#<Class:0x000055997b7b0b28>:0x000055997b601728>
Did you mean?  json
               JSON
/src/app/app/views/api/v1/users/_user.json.jbuilder:10:in `block in _app_views_api_v__users__user_json_jbuilder__3705092512957372222_23200'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:42:in `block in set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:296:in `block in _merge_block'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:347:in `_scope'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:296:in `_merge_block'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:42:in `set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder/jbuilder_template.rb:133:in `set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:70:in `method_missing'
/src/app/app/views/api/v1/users/_user.json.jbuilder:9:in `_app_views_api_v__users__user_json_jbuilder__3705092512957372222_23200'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/base.rb:274:in `_run'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:185:in `block in render'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:182:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:385:in `instrument_render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:183:in `render'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/partial_renderer.rb:357:in `block in render_partial'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/abstract_renderer.rb:88:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/abstract_renderer.rb:87:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/partial_renderer.rb:346:in `render_partial'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/partial_renderer.rb:317:in `render'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/renderer.rb:65:in `render_partial_to_object'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/renderer.rb:27:in `render_to_object'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/renderer.rb:22:in `render'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/helpers/rendering_helper.rb:34:in `block in render'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/base.rb:304:in `in_rendering_context'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/helpers/rendering_helper.rb:30:in `render'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder/jbuilder_template.rb:180:in `_render_partial'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder/jbuilder_template.rb:174:in `_render_partial_with_options'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder/jbuilder_template.rb:262:in `_render_explicit_partial'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder/jbuilder_template.rb:55:in `partial!'
/src/app/app/views/api/v1/users/show.json.jbuilder:2:in `block in _app_views_api_v__users_show_json_jbuilder___2128756885784837529_23160'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:42:in `block in set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:296:in `block in _merge_block'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:347:in `_scope'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:296:in `_merge_block'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:42:in `set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder/jbuilder_template.rb:133:in `set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:70:in `method_missing'
/src/app/app/views/api/v1/users/show.json.jbuilder:1:in `_app_views_api_v__users_show_json_jbuilder___2128756885784837529_23160'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/base.rb:274:in `_run'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:185:in `block in render'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:182:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:385:in `instrument_render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:183:in `render'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:58:in `block (2 levels) in render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/abstract_renderer.rb:88:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/abstract_renderer.rb:87:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:57:in `block in render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:65:in `render_with_layout'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:56:in `render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:13:in `render'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/renderer.rb:61:in `render_template_to_object'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/renderer.rb:29:in `render_to_object'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:117:in `block in _render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/base.rb:304:in `in_rendering_context'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:116:in `_render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:103:in `render_to_body'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/api/api_rendering.rb:13:in `render_to_body'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:52:in `render_to_body'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/renderers.rb:142:in `render_to_body'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/rendering.rb:25:in `render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:36:in `render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:44:in `block (2 levels) in render'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/core_ext/benchmark.rb:14:in `block in ms'
/usr/local/lib/ruby/2.7.0/benchmark.rb:308:in `realtime'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/core_ext/benchmark.rb:14:in `ms'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:44:in `block in render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:84:in `cleanup_view_runtime'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:34:in `cleanup_view_runtime'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:43:in `render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/implicit_render.rb:35:in `default_render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `block in send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `tap'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 1965ms (Views: 0.7ms | ActiveRecord: 2.4ms | Allocations: 544275)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-11 16:48:59 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (4.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  [1m[36mTeam Load (1.4ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/views/api/v1/users/_user.json.jbuilder:8
  Rendered api/v1/users/_user.json.jbuilder (Duration: 16.0ms | Allocations: 912)
  Rendered api/v1/users/show.json.jbuilder (Duration: 30.3ms | Allocations: 1365)
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 74ms (Views: 37.0ms | ActiveRecord: 7.3ms | Allocations: 4509)


Started POST "/api/v1/teams" for 172.25.0.1 at 2022-02-11 16:49:05 +0000
Processing by Api::V1::TeamsController#create as */*
  Parameters: {"team"=>{"name"=>"Test Team 1"}}
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mTeam Load (0.9ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/policies/team_policy.rb:11:in `create?'
not allowed to create? this Class
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:223:in `authorize'
/src/app/app/controllers/api/v1/teams_controller.rb:18:in `create'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 234ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 2705)


Started POST "/api/v1/teams" for 172.25.0.1 at 2022-02-11 17:03:36 +0000
Processing by Api::V1::TeamsController#create as */*
  Parameters: {"team"=>{"name"=>"Test Team 1"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mTeam Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 LIMIT $2[0m  [["name", "Test Team 1"], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mTeam Load (0.3ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/team.rb:29:in `team_captain_is_member'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/api/v1/teams_controller.rb:19:in `create'
Completed 422 Unprocessable Entity in 235ms (Views: 0.6ms | ActiveRecord: 3.1ms | Allocations: 20153)


Started POST "/api/v1/teams" for 172.25.0.1 at 2022-02-11 17:05:11 +0000
Processing by Api::V1::TeamsController#create as */*
  Parameters: {"team"=>{"name"=>"Test Team 1"}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:20:in `block in create'
  [1m[36mTeam Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 LIMIT $2[0m  [["name", "Test Team 1"], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mTeam Load (1.2ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/team.rb:29:in `team_captain_is_member'
  [1m[35m (1.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/api/v1/teams_controller.rb:19:in `create'
Completed 422 Unprocessable Entity in 202ms (Views: 0.8ms | ActiveRecord: 26.8ms | Allocations: 20112)


Started GET "/api/v1/teams" for 172.25.0.1 at 2022-02-11 17:05:16 +0000
Processing by Api::V1::TeamsController#index as */*
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (4.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "teams"[0m
  ↳ app/controllers/application_controller.rb:24:in `paginate'
  Rendering api/v1/teams/index.json.jbuilder
  [1m[36mTeam Load (0.7ms)[0m  [1m[34mSELECT "teams".* FROM "teams" LIMIT $1 OFFSET $2[0m  [["LIMIT", 10], ["OFFSET", 0]]
  ↳ app/views/api/v1/teams/index.json.jbuilder:2
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/views/api/v1/teams/_minimal.json.jbuilder:3
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/views/api/v1/teams/_minimal.json.jbuilder:6
  Rendered collection of api/v1/teams/_minimal.json.jbuilder [1 times] (Duration: 82.3ms | Allocations: 2659)
  Rendered api/v1/teams/index.json.jbuilder (Duration: 107.1ms | Allocations: 3838)
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 159ms (Views: 113.5ms | ActiveRecord: 8.4ms | Allocations: 8061)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateJoinRequests (20220211171229)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (67.4ms)[0m  [1m[35mCREATE TABLE "join_requests" ("id" bigserial primary key, "player_id" bigint NOT NULL, "team_id" bigint NOT NULL, "status" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_2c5d79c40c"
FOREIGN KEY ("player_id")
  REFERENCES "users" ("id")
, CONSTRAINT "fk_rails_b528ce4790"
FOREIGN KEY ("team_id")
  REFERENCES "teams" ("id")
)[0m
  [1m[35m (3.2ms)[0m  [1m[35mCREATE  INDEX  "index_join_requests_on_player_id" ON "join_requests"  ("player_id")[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE  INDEX  "index_join_requests_on_team_id" ON "join_requests"  ("team_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (7.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220211171229"]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:40:51 +0000
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mTeam Load (0.5ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/user.rb:65:in `leave_team!'
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 1]]
  ↳ app/models/user.rb:70:in `leave_team!'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/user.rb:74:in `leave_team!'
  [1m[36mUser Update All (3.1ms)[0m  [1m[33mUPDATE "users" SET "team_id" = $1 WHERE "users"."team_id" = $2[0m  [["team_id", nil], ["team_id", 1]]
  ↳ app/models/user.rb:74:in `leave_team!'
  [1m[36mTeam Destroy (3.5ms)[0m  [1m[31mDELETE FROM "teams" WHERE "teams"."id" = $1[0m  [["id", 1]]
  ↳ app/models/user.rb:74:in `leave_team!'
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/models/user.rb:74:in `leave_team!'
  Rendering api/v1/users/leave_team.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 13.5ms | Allocations: 134)
  Rendered api/v1/users/leave_team.json.jbuilder (Duration: 33.1ms | Allocations: 563)
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 273ms (Views: 40.2ms | ActiveRecord: 13.2ms | Allocations: 24261)


Started GET "/api/v1/teams" for 172.25.0.1 at 2022-02-11 17:41:06 +0000
Processing by Api::V1::TeamsController#index as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "teams"[0m
  ↳ app/controllers/application_controller.rb:24:in `paginate'
  Rendering api/v1/teams/index.json.jbuilder
  [1m[36mTeam Load (1.0ms)[0m  [1m[34mSELECT "teams".* FROM "teams" LIMIT $1 OFFSET $2[0m  [["LIMIT", 10], ["OFFSET", 0]]
  ↳ app/views/api/v1/teams/index.json.jbuilder:2
  Rendered collection of api/v1/teams/_minimal.json.jbuilder [0 times] (Duration: 0.1ms | Allocations: 3)
  Rendered api/v1/teams/index.json.jbuilder (Duration: 32.8ms | Allocations: 1057)
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 141ms (Views: 36.9ms | ActiveRecord: 4.6ms | Allocations: 5397)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:41:17 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/leave_team.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 0.3ms | Allocations: 49)
  Rendered api/v1/users/leave_team.json.jbuilder (Duration: 4.2ms | Allocations: 241)
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 31ms (Views: 15.6ms | ActiveRecord: 1.1ms | Allocations: 3050)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:41:19 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/leave_team.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 0.2ms | Allocations: 49)
  Rendered api/v1/users/leave_team.json.jbuilder (Duration: 12.2ms | Allocations: 241)
  [1m[36mUser Load (3.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 125ms (Views: 30.4ms | ActiveRecord: 3.7ms | Allocations: 3051)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:43:33 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/leave_team.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 0.1ms | Allocations: 55)
  Rendered api/v1/users/leave_team.json.jbuilder (Duration: 4.1ms | Allocations: 247)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 286ms (Views: 32.3ms | ActiveRecord: 25.5ms | Allocations: 15788)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:43:43 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
undefined method `leave_team!' for #<User:0x000055997d186480>
Did you mean?  leave_team
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/attribute_methods.rb:432:in `method_missing'
/src/app/app/controllers/api/v1/users_controller.rb:17:in `leave_team'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 612ms (Views: 0.3ms | ActiveRecord: 6.7ms | Allocations: 18060)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:51:22 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
undefined method `errors' for "You don't have a team":String
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/validations.rb:21:in `initialize'
/src/app/app/models/user.rb:66:in `new'
/src/app/app/models/user.rb:66:in `leave_team!'
/src/app/app/controllers/api/v1/users_controller.rb:17:in `leave_team'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 819ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 15262)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:52:46 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
undefined method `errors' for #<ActiveModel::Errors:0x000055997d135e90>
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/validations.rb:21:in `initialize'
/src/app/app/models/user.rb:67:in `new'
/src/app/app/models/user.rb:67:in `leave_team!'
/src/app/app/controllers/api/v1/users_controller.rb:17:in `leave_team'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 500ms (Views: 0.2ms | ActiveRecord: 13.5ms | Allocations: 15454)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:53:11 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 132ms (Views: 0.1ms | ActiveRecord: 5.3ms | Allocations: 14099)


Started POST "/api/v1/teams" for 172.25.0.1 at 2022-02-11 17:53:36 +0000
Processing by Api::V1::TeamsController#create as */*
  Parameters: {"team"=>{"name"=>"Test Team 1"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:20:in `block in create'
  [1m[36mTeam Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 LIMIT $2[0m  [["name", "Test Team 1"], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mTeam Create (9.8ms)[0m  [1m[32mINSERT INTO "teams" ("name", "created_at", "updated_at", "captain_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Test Team 1"], ["created_at", "2022-02-11 17:53:37.299900"], ["updated_at", "2022-02-11 17:53:37.299900"], ["captain_id", 3]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231232"], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:23:in `block in create'
  [1m[36mUser Update (1.6ms)[0m  [1m[33mUPDATE "users" SET "team_id" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["team_id", 2], ["updated_at", "2022-02-11 17:53:37.343475"], ["id", 3]]
  ↳ app/controllers/api/v1/teams_controller.rb:23:in `block in create'
  [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/teams_controller.rb:19:in `create'
  Rendering api/v1/teams/create.json.jbuilder
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 2]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:3
  Rendered api/v1/users/_minimal.json.jbuilder (Duration: 6.7ms | Allocations: 89)
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 2]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:8
  Rendered collection of api/v1/users/_minimal.json.jbuilder [1 times] (Duration: 2.3ms | Allocations: 110)
  Rendered api/v1/teams/_team.json.jbuilder (Duration: 60.3ms | Allocations: 2628)
  Rendered api/v1/teams/create.json.jbuilder (Duration: 72.7ms | Allocations: 3142)
  [1m[36mUser Load (2.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 345ms (Views: 75.4ms | ActiveRecord: 36.8ms | Allocations: 27562)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-11 17:53:45 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  [1m[36mTeam Load (0.5ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/views/api/v1/users/_user.json.jbuilder:8
  Rendered api/v1/users/_user.json.jbuilder (Duration: 12.4ms | Allocations: 1027)
  Rendered api/v1/users/show.json.jbuilder (Duration: 16.7ms | Allocations: 1306)
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 74ms (Views: 20.3ms | ActiveRecord: 1.6ms | Allocations: 4602)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:53:49 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mTeam Load (0.9ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/models/user.rb:65:in `leave_team!'
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 2]]
  ↳ app/models/user.rb:71:in `leave_team!'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/user.rb:76:in `leave_team!'
  [1m[36mUser Update All (0.8ms)[0m  [1m[33mUPDATE "users" SET "team_id" = $1 WHERE "users"."team_id" = $2[0m  [["team_id", nil], ["team_id", 2]]
  ↳ app/models/user.rb:76:in `leave_team!'
  [1m[36mTeam Destroy (1.3ms)[0m  [1m[31mDELETE FROM "teams" WHERE "teams"."id" = $1[0m  [["id", 2]]
  ↳ app/models/user.rb:76:in `leave_team!'
  [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/models/user.rb:76:in `leave_team!'
  Rendering api/v1/users/leave_team.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 0.2ms | Allocations: 49)
  Rendered api/v1/users/leave_team.json.jbuilder (Duration: 3.7ms | Allocations: 242)
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 100ms (Views: 12.0ms | ActiveRecord: 9.0ms | Allocations: 7259)


Started POST "/api/v1/user/leave_team" for 172.25.0.1 at 2022-02-11 17:53:52 +0000
Processing by Api::V1::UsersController#leave_team as */*
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 9ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 1491)


Started POST "/api/v1/teams" for 172.25.0.1 at 2022-02-11 17:58:12 +0000
Processing by Api::V1::TeamsController#create as */*
  Parameters: {"team"=>{"name"=>"Test Team 1"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:20:in `block in create'
  [1m[36mTeam Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 LIMIT $2[0m  [["name", "Test Team 1"], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mTeam Create (3.1ms)[0m  [1m[32mINSERT INTO "teams" ("name", "created_at", "updated_at", "captain_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Test Team 1"], ["created_at", "2022-02-11 17:58:12.614381"], ["updated_at", "2022-02-11 17:58:12.614381"], ["captain_id", 3]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mUser Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231232"], ["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:23:in `block in create'
  [1m[36mUser Update (1.2ms)[0m  [1m[33mUPDATE "users" SET "team_id" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["team_id", 3], ["updated_at", "2022-02-11 17:58:12.642212"], ["id", 3]]
  ↳ app/controllers/api/v1/teams_controller.rb:23:in `block in create'
  [1m[35m (4.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/teams_controller.rb:19:in `create'
  Rendering api/v1/teams/create.json.jbuilder
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 3]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:3
  Rendered api/v1/users/_minimal.json.jbuilder (Duration: 0.3ms | Allocations: 27)
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 3]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:8
  Rendered collection of api/v1/users/_minimal.json.jbuilder [1 times] (Duration: 0.2ms | Allocations: 45)
  Rendered api/v1/teams/_team.json.jbuilder (Duration: 31.1ms | Allocations: 2114)
  Rendered api/v1/teams/create.json.jbuilder (Duration: 36.3ms | Allocations: 2398)
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 294ms (Views: 40.6ms | ActiveRecord: 28.1ms | Allocations: 26640)


Started POST "/api/v1/teams" for 172.25.0.1 at 2022-02-11 17:58:21 +0000
Processing by Api::V1::TeamsController#create as */*
  Parameters: {"team"=>{"name"=>"Test Team 1"}}
  [1m[36mUser Load (2.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (3.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mTeam Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "teams" WHERE "teams"."name" = $1 LIMIT $2[0m  [["name", "Test Team 1"], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/teams_controller.rb:22:in `block in create'
  [1m[36mTeam Load (1.5ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/models/team.rb:30:in `team_captain_is_member'
  [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/api/v1/teams_controller.rb:19:in `create'
Completed 422 Unprocessable Entity in 75ms (Views: 0.4ms | ActiveRecord: 8.5ms | Allocations: 5513)


Started GET "/api/v1/teams" for 172.25.0.1 at 2022-02-11 17:59:14 +0000
Processing by Api::V1::TeamsController#index as */*
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "teams"[0m
  ↳ app/controllers/application_controller.rb:24:in `paginate'
  Rendering api/v1/teams/index.json.jbuilder
  [1m[36mTeam Load (0.3ms)[0m  [1m[34mSELECT "teams".* FROM "teams" LIMIT $1 OFFSET $2[0m  [["LIMIT", 10], ["OFFSET", 0]]
  ↳ app/views/api/v1/teams/index.json.jbuilder:2
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 3]]
  ↳ app/views/api/v1/teams/_minimal.json.jbuilder:3
  [1m[36mUser Load (8.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/views/api/v1/teams/_minimal.json.jbuilder:6
  Rendered collection of api/v1/teams/_minimal.json.jbuilder [1 times] (Duration: 69.8ms | Allocations: 1980)
  Rendered api/v1/teams/index.json.jbuilder (Duration: 96.6ms | Allocations: 2911)
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 164ms (Views: 104.2ms | ActiveRecord: 13.5ms | Allocations: 6676)


Started GET "/api/v1/teams/3/join_requests" for 172.25.0.1 at 2022-02-11 17:59:50 +0000
  
Zeitwerk::NameError (expected file /src/app/app/controllers/api/v1/join_requests_controller.rb to define constant Api::V1::JoinRequestsController, but didn't):
  
zeitwerk (2.5.4) lib/zeitwerk/loader/callbacks.rb:25:in `on_file_autoloaded'
zeitwerk (2.5.4) lib/zeitwerk/kernel.rb:28:in `require'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:284:in `const_get'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:284:in `block in constantize'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:280:in `each'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:280:in `inject'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:280:in `constantize'
activesupport (6.0.4.4) lib/active_support/dependencies/zeitwerk_integration.rb:19:in `constantize'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:89:in `controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/parameters.rb:100:in `binary_params_for?'
actionpack (6.0.4.4) lib/action_dispatch/http/parameters.rb:91:in `set_binary_encoding'
actionpack (6.0.4.4) lib/action_dispatch/http/parameters.rb:69:in `path_parameters='
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:47:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/api/v1/join_requests" for 172.25.0.1 at 2022-02-11 18:03:18 +0000
  
Zeitwerk::NameError (expected file /src/app/app/controllers/api/v1/join_requests_controller.rb to define constant Api::V1::JoinRequestsController, but didn't):
  
zeitwerk (2.5.4) lib/zeitwerk/loader/callbacks.rb:25:in `on_file_autoloaded'
zeitwerk (2.5.4) lib/zeitwerk/kernel.rb:28:in `require'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:284:in `const_get'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:284:in `block in constantize'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:280:in `each'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:280:in `inject'
activesupport (6.0.4.4) lib/active_support/inflector/methods.rb:280:in `constantize'
activesupport (6.0.4.4) lib/active_support/dependencies/zeitwerk_integration.rb:19:in `constantize'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:89:in `controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/parameters.rb:100:in `binary_params_for?'
actionpack (6.0.4.4) lib/action_dispatch/http/parameters.rb:91:in `set_binary_encoding'
actionpack (6.0.4.4) lib/action_dispatch/http/parameters.rb:69:in `path_parameters='
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:47:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/api/v1/join_requests" for 172.25.0.1 at 2022-02-11 18:03:39 +0000
Processing by Api::V1::JoinRequestsController#index as */*
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
superclass mismatch for class Scope
/src/app/app/policies/join_request_policy.rb:18:in `<class:TeamPolicy>'
/src/app/app/policies/join_request_policy.rb:1:in `<main>'
/src/bundle/gems/bootsnap-1.10.3/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'
/src/bundle/gems/bootsnap-1.10.3/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'
/src/bundle/gems/zeitwerk-2.5.4/lib/zeitwerk/kernel.rb:27:in `require'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:282:in `const_get'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:282:in `block in constantize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:280:in `each'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:280:in `inject'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:280:in `constantize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:325:in `safe_constantize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/core_ext/string/inflections.rb:79:in `safe_constantize'
/src/bundle/gems/pundit-2.1.1/lib/pundit/policy_finder.rb:40:in `policy'
/src/bundle/gems/pundit-2.1.1/lib/pundit/policy_finder.rb:54:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:141:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:261:in `policy'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:221:in `authorize'
/src/app/app/controllers/api/v1/join_requests_controller.rb:8:in `index'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 593ms (Views: 0.2ms | ActiveRecord: 3.9ms | Allocations: 15554)


Started GET "/api/v1/join_requests" for 172.25.0.1 at 2022-02-11 18:04:48 +0000
Processing by Api::V1::JoinRequestsController#index as */*
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
superclass mismatch for class Scope
/src/app/app/policies/join_request_policy.rb:18:in `<class:TeamPolicy>'
/src/app/app/policies/join_request_policy.rb:1:in `<main>'
/src/bundle/gems/bootsnap-1.10.3/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'
/src/bundle/gems/bootsnap-1.10.3/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'
/src/bundle/gems/zeitwerk-2.5.4/lib/zeitwerk/kernel.rb:27:in `require'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:282:in `const_get'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:282:in `block in constantize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:280:in `each'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:280:in `inject'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:280:in `constantize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/inflector/methods.rb:325:in `safe_constantize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/core_ext/string/inflections.rb:79:in `safe_constantize'
/src/bundle/gems/pundit-2.1.1/lib/pundit/policy_finder.rb:40:in `policy'
/src/bundle/gems/pundit-2.1.1/lib/pundit/policy_finder.rb:54:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:141:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:261:in `policy'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:221:in `authorize'
/src/app/app/controllers/api/v1/join_requests_controller.rb:8:in `index'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 442ms (Views: 1.8ms | ActiveRecord: 5.6ms | Allocations: 15413)


Started GET "/api/v1/join_requests" for 172.25.0.1 at 2022-02-11 18:06:05 +0000
Processing by Api::V1::JoinRequestsController#index as */*
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mTeam Load (0.5ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/policies/join_request_policy.rb:3:in `index?'
  [1m[36mJoinRequest Load (0.4ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."team_id" = $1 LIMIT $2[0m  [["team_id", 3], ["LIMIT", 1]]
  ↳ app/policies/join_request_policy.rb:21:in `resolve'
No template found for Api::V1::JoinRequestsController#index, rendering head :no_content
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 204 No Content in 458ms (ActiveRecord: 12.5ms | Allocations: 24990)


  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateJoinRequests (20220211171229)
  [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (16.8ms)[0m  [1m[35mDROP TABLE "join_requests"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (4.7ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20220211171229"]]
  [1m[35m (5.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateJoinRequests (20220211171229)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (18.4ms)[0m  [1m[35mCREATE TABLE "join_requests" ("id" bigserial primary key, "player_id" bigint NOT NULL, "team_id" bigint NOT NULL, "status" integer DEFAULT 0, "message" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_2c5d79c40c"
FOREIGN KEY ("player_id")
  REFERENCES "users" ("id")
, CONSTRAINT "fk_rails_b528ce4790"
FOREIGN KEY ("team_id")
  REFERENCES "teams" ("id")
)[0m
  [1m[35m (3.4ms)[0m  [1m[35mCREATE  INDEX  "index_join_requests_on_player_id" ON "join_requests"  ("player_id")[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE  INDEX  "index_join_requests_on_team_id" ON "join_requests"  ("team_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220211171229"]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:26:37 +0000
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
unable to find policy `JoinRequestPolicy` for `JoinRequest(id: integer, player_id: integer, team_id: integer, status: integer, created_at: datetime, updated_at: datetime)`
/src/bundle/gems/pundit-2.1.1/lib/pundit/policy_finder.rb:54:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:141:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:261:in `policy'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:221:in `authorize'
/src/app/app/controllers/api/v1/user_requests_controller.rb:8:in `index'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 384ms (Views: 0.3ms | ActiveRecord: 1.9ms | Allocations: 15081)


Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:28:50 +0000
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
unable to find policy `JoinRequestPolicy` for `JoinRequest(id: integer, player_id: integer, team_id: integer, status: integer, message: text, created_at: datetime, updated_at: datetime)`
/src/bundle/gems/pundit-2.1.1/lib/pundit/policy_finder.rb:54:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:141:in `policy!'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:261:in `policy'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:221:in `authorize'
/src/app/app/controllers/api/v1/user_requests_controller.rb:8:in `index'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 489ms (Views: 1.1ms | ActiveRecord: 15.0ms | Allocations: 15556)


Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:36:10 +0000
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
unknown keyword: :policy_class
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:250:in `policy_scope'
/src/app/app/controllers/api/v1/user_requests_controller.rb:9:in `index'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 402ms (Views: 0.3ms | ActiveRecord: 1.7ms | Allocations: 14926)


Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:37:12 +0000
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (0.7ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 LIMIT $2[0m  [["player_id", 3], ["LIMIT", 1]]
  ↳ app/policies/user_request_policy.rb:21:in `resolve'
No template found for Api::V1::UserRequestsController#index, rendering head :no_content
  [1m[36mUser Load (5.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 204 No Content in 204ms (ActiveRecord: 16.9ms | Allocations: 18639)


Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:38:51 +0000
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (0.7ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 LIMIT $2[0m  [["player_id", 3], ["LIMIT", 1]]
  ↳ app/policies/user_request_policy.rb:21:in `resolve'
No template found for Api::V1::UserRequestsController#index, rendering head :no_content
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 204 No Content in 37ms (ActiveRecord: 2.7ms | Allocations: 3295)


Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:38:54 +0000
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (1.1ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 LIMIT $2[0m  [["player_id", 3], ["LIMIT", 1]]
  ↳ app/policies/user_request_policy.rb:21:in `resolve'
No template found for Api::V1::UserRequestsController#index, rendering head :no_content
  [1m[36mUser Load (3.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 204 No Content in 32ms (ActiveRecord: 6.4ms | Allocations: 3295)


Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:42:36 +0000
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (6.2ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 LIMIT $2[0m  [["player_id", 3], ["LIMIT", 1]]
  ↳ app/policies/user_request_policy.rb:21:in `resolve'
No template found for Api::V1::UserRequestsController#index, rendering head :no_content
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 204 No Content in 81ms (ActiveRecord: 9.1ms | Allocations: 6259)


Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:42:37 +0000
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (0.6ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 LIMIT $2[0m  [["player_id", 3], ["LIMIT", 1]]
  ↳ app/policies/user_request_policy.rb:21:in `resolve'
No template found for Api::V1::UserRequestsController#index, rendering head :no_content
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 204 No Content in 34ms (ActiveRecord: 3.5ms | Allocations: 3296)


Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 18:46:10 +0000
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (0.8ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 LIMIT $2[0m  [["player_id", 3], ["LIMIT", 1]]
  ↳ app/policies/user_request_policy.rb:21:in `resolve'
  Rendering api/v1/user_requests/index.json.jbuilder
  Rendered collection of api/v1/join_requests/_minimal.json.jbuilder [0 times] (Duration: 0.0ms | Allocations: 3)
  Rendered api/v1/user_requests/index.json.jbuilder (Duration: 13.3ms | Allocations: 379)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 179ms (Views: 20.6ms | ActiveRecord: 10.3ms | Allocations: 17970)


  [1m[35m (2.4ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (2.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (4.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (2.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/api/v1/requests" for 172.25.0.1 at 2022-02-11 20:53:40 +0000
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Api::V1::UserRequestsController#index as */*
  [1m[36mUser Load (3.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (2.1ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 LIMIT $2[0m  [["player_id", 3], ["LIMIT", 1]]
  ↳ app/policies/user_request_policy.rb:29:in `resolve'
  Rendering api/v1/user_requests/index.json.jbuilder
  Rendered collection of api/v1/join_requests/_minimal.json.jbuilder [0 times] (Duration: 0.8ms | Allocations: 3)
  Rendered api/v1/user_requests/index.json.jbuilder (Duration: 21.7ms | Allocations: 597)
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 364ms (Views: 61.7ms | ActiveRecord: 15.7ms | Allocations: 23841)


Started GET "/api/v1/user" for 172.25.0.1 at 2022-02-11 20:53:52 +0000
Processing by Api::V1::UsersController#show as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player1@derby.com"], ["LIMIT", 1]]
  Rendering api/v1/users/show.json.jbuilder
  [1m[36mTeam Load (3.7ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/views/api/v1/users/_user.json.jbuilder:8
  Rendered api/v1/users/_user.json.jbuilder (Duration: 184.4ms | Allocations: 7318)
  Rendered api/v1/users/show.json.jbuilder (Duration: 190.6ms | Allocations: 7769)
  [1m[36mUser Load (3.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 200 OK in 222ms (Views: 189.1ms | ActiveRecord: 10.9ms | Allocations: 11055)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-11 20:54:29 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"player2@derby.com", "phone_number"=>"01231231238", "password"=>"[FILTERED]", "name"=>"player2", "role"=>"player", "registration"=>{"email"=>"player2@derby.com", "phone_number"=>"01231231238", "password"=>"[FILTERED]", "name"=>"player2", "role"=>"player"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "player2@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "01231231238"], ["LIMIT", 1]]
  [1m[36mUser Create (5.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "player2@derby.com"], ["encrypted_password", "$2a$12$A.BqH04or19.Ep2Qgj7TeeyTzYrjEw2mgoP5ZHuxdGQwz/6wI22je"], ["name", "player2"], ["email", "player2@derby.com"], ["phone_number", "01231231238"], ["created_at", "2022-02-11 20:54:30.706326"], ["updated_at", "2022-02-11 20:54:30.706326"]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231238"], ["id", 9], ["LIMIT", 1]]
  [1m[36mUser Update (0.8ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"YJZmLWe-dy7t-oDnpOhhxg\\\":{\\\"token\\\":\\\"$2a$10$YWV/mLMfdsylwV3vfc4OEujm7Gx7gRltLeRwDRIBMihcnRLLC6GFe\\\",\\\"expiry\\\":1645822470}}\""], ["updated_at", "2022-02-11 20:54:30.798963"], ["id", 9]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
Completed 200 OK in 791ms (Views: 0.5ms | ActiveRecord: 18.3ms | Allocations: 30724)


Started GET "/api/v1/teams" for 172.25.0.1 at 2022-02-11 20:56:01 +0000
Processing by Api::V1::TeamsController#index as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
  [1m[35m (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "teams"[0m
  ↳ app/controllers/application_controller.rb:24:in `paginate'
  Rendering api/v1/teams/index.json.jbuilder
  [1m[36mTeam Load (0.6ms)[0m  [1m[34mSELECT "teams".* FROM "teams" LIMIT $1 OFFSET $2[0m  [["LIMIT", 10], ["OFFSET", 0]]
  ↳ app/views/api/v1/teams/index.json.jbuilder:2
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 3]]
  ↳ app/views/api/v1/teams/_minimal.json.jbuilder:3
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/views/api/v1/teams/_minimal.json.jbuilder:6
  Rendered collection of api/v1/teams/_minimal.json.jbuilder [1 times] (Duration: 64.3ms | Allocations: 3800)
  Rendered api/v1/teams/index.json.jbuilder (Duration: 79.1ms | Allocations: 4964)
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
Completed 200 OK in 213ms (Views: 82.0ms | ActiveRecord: 5.9ms | Allocations: 9481)


Started GET "/api/v1/teams/3/requests" for 172.25.0.1 at 2022-02-11 20:56:14 +0000
Processing by Api::V1::TeamRequestsController#index as */*
  Parameters: {"team_id"=>"3"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
undefined method `captain_id' for nil:NilClass
/src/app/app/policies/team_request_policy.rb:3:in `index?'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:223:in `public_send'
/src/bundle/gems/pundit-2.1.1/lib/pundit.rb:223:in `authorize'
/src/app/app/controllers/api/v1/team_requests_controller.rb:29:in `authorize_with_policy'
/src/app/app/controllers/api/v1/team_requests_controller.rb:8:in `index'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 218ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2526)


Started GET "/api/v1/teams/3/requests" for 172.25.0.1 at 2022-02-11 20:57:23 +0000
Processing by Api::V1::TeamRequestsController#index as */*
  Parameters: {"team_id"=>"3"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
Completed 401 Unauthorized in 253ms (Views: 0.5ms | ActiveRecord: 6.3ms | Allocations: 17012)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 20:59:01 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
undefined method `join_requests' for #<User:0x00007fac1856c270>
Did you mean?  requests
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/attribute_methods.rb:432:in `method_missing'
/src/app/app/controllers/api/v1/user_requests_controller.rb:18:in `create'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 268ms (Views: 0.2ms | ActiveRecord: 7.5ms | Allocations: 21235)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 21:00:44 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
unknown attribute 'user_id' for JoinRequest.
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/attribute_assignment.rb:52:in `_assign_attribute'
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/attribute_assignment.rb:43:in `block in _assign_attributes'
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/attribute_assignment.rb:42:in `each'
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/attribute_assignment.rb:42:in `_assign_attributes'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/attribute_assignment.rb:21:in `_assign_attributes'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/association.rb:190:in `initialize_attributes'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/association.rb:321:in `block in build_record'
/src/bundle/gems/state_machines-activerecord-0.8.0/lib/state_machines/integrations/active_record.rb:462:in `block in initialize'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/core.rb:326:in `initialize'
/src/bundle/gems/state_machines-activerecord-0.8.0/lib/state_machines/integrations/active_record.rb:458:in `initialize'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/inheritance.rb:70:in `new'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/inheritance.rb:70:in `new'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/reflection.rb:157:in `build_association'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/association.rb:320:in `build_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:337:in `build_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:350:in `_create_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/has_many_association.rb:115:in `_create_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/association.rb:199:in `create!'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_proxy.rb:364:in `create!'
/src/app/app/controllers/api/v1/user_requests_controller.rb:18:in `create'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 420ms (Views: 0.4ms | ActiveRecord: 10.5ms | Allocations: 20941)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 21:02:26 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mTeam Load (1.3ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mJoinRequest Create (5.0ms)[0m  [1m[32mINSERT INTO "join_requests" ("player_id", "team_id", "message", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["player_id", 9], ["team_id", 3], ["message", "I want to join"], ["created_at", "2022-02-11 21:02:27.100815"], ["updated_at", "2022-02-11 21:02:27.100815"]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  Rendering api/v1/user_requests/create.json.jbuilder
  Rendered api/v1/user_requests/create.json.jbuilder (Duration: 6.7ms | Allocations: 266)
{:request=>#<JoinRequest id: 1, player_id: 9, team_id: 3, status: 0, message: "I want to join", created_at: "2022-02-11 21:02:27", updated_at: "2022-02-11 21:02:27">} is not a symbol nor a string
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:290:in `public_send'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:290:in `block in _extract_method_values'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:290:in `each'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:290:in `_extract_method_values'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:248:in `extract!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:62:in `block in set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:296:in `block in _merge_block'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:347:in `_scope'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:296:in `_merge_block'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:62:in `set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder/jbuilder_template.rb:133:in `set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:72:in `method_missing'
/src/app/app/views/api/v1/user_requests/create.json.jbuilder:2:in `block in _app_views_api_v__user_requests_create_json_jbuilder___4164361687862967610_72920'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:42:in `block in set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:296:in `block in _merge_block'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:347:in `_scope'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:296:in `_merge_block'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:42:in `set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder/jbuilder_template.rb:133:in `set!'
/src/bundle/gems/jbuilder-2.11.5/lib/jbuilder.rb:70:in `method_missing'
/src/app/app/views/api/v1/user_requests/create.json.jbuilder:1:in `_app_views_api_v__user_requests_create_json_jbuilder___4164361687862967610_72920'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/base.rb:274:in `_run'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:185:in `block in render'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:182:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:385:in `instrument_render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/template.rb:183:in `render'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:58:in `block (2 levels) in render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/abstract_renderer.rb:88:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/abstract_renderer.rb:87:in `instrument'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:57:in `block in render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:65:in `render_with_layout'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:56:in `render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/template_renderer.rb:13:in `render'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/renderer.rb:61:in `render_template_to_object'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/renderer/renderer.rb:29:in `render_to_object'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:117:in `block in _render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/base.rb:304:in `in_rendering_context'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:116:in `_render_template'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:103:in `render_to_body'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/api/api_rendering.rb:13:in `render_to_body'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:52:in `render_to_body'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/renderers.rb:142:in `render_to_body'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/rendering.rb:25:in `render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:36:in `render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:44:in `block (2 levels) in render'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/core_ext/benchmark.rb:14:in `block in ms'
/usr/local/lib/ruby/2.7.0/benchmark.rb:308:in `realtime'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/core_ext/benchmark.rb:14:in `ms'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:44:in `block in render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:84:in `cleanup_view_runtime'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:34:in `cleanup_view_runtime'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:43:in `render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/implicit_render.rb:35:in `default_render'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `block in send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `tap'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 634ms (Views: 0.2ms | ActiveRecord: 19.2ms | Allocations: 32175)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 21:04:51 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
  [1m[35m (1.8ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mTeam Load (0.6ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mJoinRequest Create (1.1ms)[0m  [1m[32mINSERT INTO "join_requests" ("player_id", "team_id", "message", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["player_id", 9], ["team_id", 3], ["message", "I want to join"], ["created_at", "2022-02-11 21:04:51.189862"], ["updated_at", "2022-02-11 21:04:51.189862"]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[35m (4.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  Rendering api/v1/user_requests/create.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 1.8ms | Allocations: 138)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 3]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:3
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:5
  Rendered api/v1/users/_minimal.json.jbuilder (Duration: 3.2ms | Allocations: 92)
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 3]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:8
  Rendered collection of api/v1/users/_minimal.json.jbuilder [1 times] (Duration: 1.4ms | Allocations: 110)
  Rendered api/v1/teams/_team.json.jbuilder (Duration: 55.0ms | Allocations: 3760)
  Rendered api/v1/join_requests/_request.json.jbuilder (Duration: 69.4ms | Allocations: 4520)
  Rendered api/v1/user_requests/create.json.jbuilder (Duration: 80.9ms | Allocations: 5172)
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
Completed 200 OK in 205ms (Views: 85.0ms | ActiveRecord: 13.4ms | Allocations: 14763)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 21:18:32 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mUser Load (3.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mTeam Load (0.7ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mJoinRequest Load (0.3ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 AND "join_requests"."team_id" = $2 LIMIT $3[0m  [["player_id", 9], ["team_id", 3], ["LIMIT", 1]]
  ↳ app/models/join_request.rb:69:in `unique_request'
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
undefined method `empty?' for #<JoinRequest:0x00007fac30663f30>
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/attribute_methods.rb:432:in `method_missing'
/src/app/app/models/join_request.rb:69:in `unique_request'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:428:in `block in make_lambda'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:181:in `block (2 levels) in halting_and_conditional'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:605:in `block (2 levels) in default_terminator'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:604:in `catch'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:604:in `block in default_terminator'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:182:in `block in halting_and_conditional'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:513:in `block in invoke_before'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:513:in `each'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:513:in `invoke_before'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:134:in `run_callbacks'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:825:in `_run_validate_callbacks'
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/validations.rb:406:in `run_validations!'
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/validations/callbacks.rb:117:in `block in run_validations!'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:112:in `block in run_callbacks'
/src/bundle/gems/state_machines-activemodel-0.8.0/lib/state_machines/integrations/active_model.rb:400:in `block in around_validation'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:150:in `block in run_actions'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:170:in `catch_exceptions'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:148:in `run_actions'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:133:in `run_callbacks'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:212:in `run_callbacks'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:63:in `block (2 levels) in perform'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:63:in `catch'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:63:in `block in perform'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:186:in `within_transaction'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:62:in `perform'
/src/bundle/gems/state_machines-activemodel-0.8.0/lib/state_machines/integrations/active_model.rb:400:in `around_validation'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:121:in `block in run_callbacks'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:139:in `run_callbacks'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:825:in `_run_validation_callbacks'
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/validations/callbacks.rb:117:in `run_validations!'
/src/bundle/gems/activemodel-6.0.4.4/lib/active_model/validations.rb:337:in `valid?'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/validations.rb:68:in `valid?'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/validations.rb:84:in `perform_validations'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/validations.rb:53:in `save!'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:318:in `block in save!'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:375:in `block in with_transaction_returning_status'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/database_statements.rb:278:in `transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:212:in `transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:366:in `with_transaction_returning_status'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:318:in `save!'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/suppressor.rb:48:in `save!'
/src/bundle/gems/state_machines-activerecord-0.8.0/lib/state_machines/integrations/active_record.rb:515:in `block in save!'
/src/bundle/gems/state_machines-activerecord-0.8.0/lib/state_machines/integrations/active_record.rb:530:in `block in around_save'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:150:in `block in run_actions'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:170:in `catch_exceptions'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:148:in `run_actions'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:133:in `run_callbacks'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:212:in `run_callbacks'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:63:in `block (2 levels) in perform'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:63:in `catch'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:63:in `block in perform'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:186:in `within_transaction'
/src/bundle/gems/state_machines-0.5.0/lib/state_machines/transition_collection.rb:62:in `perform'
/src/bundle/gems/state_machines-activerecord-0.8.0/lib/state_machines/integrations/active_record.rb:530:in `around_save'
/src/bundle/gems/state_machines-activerecord-0.8.0/lib/state_machines/integrations/active_record.rb:515:in `save!'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:367:in `insert_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/has_many_association.rb:36:in `insert_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:354:in `block (2 levels) in _create_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:454:in `replace_on_target'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:285:in `add_to_target'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:353:in `block in _create_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:135:in `block in transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/database_statements.rb:280:in `block in transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/transaction.rb:280:in `block in within_new_transaction'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:26:in `block (2 levels) in synchronize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `handle_interrupt'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:25:in `block in synchronize'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `handle_interrupt'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/concurrency/load_interlock_aware_monitor.rb:21:in `synchronize'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/transaction.rb:278:in `within_new_transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/connection_adapters/abstract/database_statements.rb:280:in `transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/transactions.rb:212:in `transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:134:in `transaction'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_association.rb:351:in `_create_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/has_many_association.rb:115:in `_create_record'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/association.rb:199:in `create!'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/associations/collection_proxy.rb:364:in `create!'
/src/app/app/controllers/api/v1/user_requests_controller.rb:18:in `create'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:195:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rendering.rb:30:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:42:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:135:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/callbacks.rb:41:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/rescue.rb:22:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `block in instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications/instrumenter.rb:24:in `instrument'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/notifications.rb:180:in `instrument'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/instrumentation.rb:32:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/railties/controller_runtime.rb:27:in `process_action'
/src/bundle/gems/actionpack-6.0.4.4/lib/abstract_controller/base.rb:136:in `process'
/src/bundle/gems/actionview-6.0.4.4/lib/action_view/rendering.rb:39:in `process'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:190:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_controller/metal.rb:254:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:33:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:49:in `block in serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `each'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/journey/router.rb:32:in `serve'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/routing/route_set.rb:834:in `call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:36:in `block in call'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `catch'
/src/bundle/gems/warden-1.2.9/lib/warden/manager.rb:34:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/etag.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/conditional_get.rb:40:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/head.rb:12:in `call'
/src/bundle/gems/activerecord-6.0.4.4/lib/active_record/migration.rb:567:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/callbacks.rb:101:in `run_callbacks'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/callbacks.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:37:in `call_app'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `block in call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `block in tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:28:in `tagged'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/tagged_logging.rb:80:in `tagged'
/src/bundle/gems/railties-6.0.4.4/lib/rails/rack/logger.rb:26:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/request_id.rb:27:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/runtime.rb:22:in `call'
/src/bundle/gems/activesupport-6.0.4.4/lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/executor.rb:14:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/static.rb:126:in `call'
/src/bundle/gems/rack-2.2.3/lib/rack/sendfile.rb:110:in `call'
/src/bundle/gems/actionpack-6.0.4.4/lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
/src/bundle/gems/railties-6.0.4.4/lib/rails/engine.rb:527:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/configuration.rb:228:in `call'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:718:in `handle_request'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:472:in `process_client'
/src/bundle/gems/puma-4.3.10/lib/puma/server.rb:328:in `block in run'
/src/bundle/gems/puma-4.3.10/lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Completed 500 Internal Server Error in 699ms (Views: 0.2ms | ActiveRecord: 6.9ms | Allocations: 33309)


  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (1.3ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 AND "join_requests"."team_id" = $2 LIMIT $3[0m  [["player_id", 9], ["team_id", 3], ["LIMIT", 1]]
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mJoinRequest Load (2.3ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 AND "join_requests"."team_id" = $2 LIMIT $3[0m  [["player_id", 9], ["team_id", 4], ["LIMIT", 1]]
Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-11 21:20:29 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"player2@derby.com", "phone_number"=>"01231231238", "password"=>"[FILTERED]", "name"=>"player2", "role"=>"player", "registration"=>{"email"=>"player2@derby.com", "phone_number"=>"01231231238", "password"=>"[FILTERED]", "name"=>"player2", "role"=>"player"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "player2@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "01231231238"], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 314ms (Views: 0.4ms | ActiveRecord: 13.4ms | Allocations: 19760)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 21:20:38 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "null"], ["LIMIT", 1]]
Filter chain halted as :authenticate_user! rendered or redirected
Completed 401 Unauthorized in 7ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1414)


Started POST "/api/v1/auth/sign_in" for 172.25.0.1 at 2022-02-11 21:20:44 +0000
Processing by DeviseTokenAuth::SessionsController#create as */*
  Parameters: {"email"=>"player2@derby.com", "password"=>"[FILTERED]", "session"=>{"email"=>"player2@derby.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "player2@derby.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231238"], ["id", 9], ["LIMIT", 1]]
  [1m[36mUser Update (1.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"YJZmLWe-dy7t-oDnpOhhxg\\\":{\\\"token\\\":\\\"$2a$10$YWV/mLMfdsylwV3vfc4OEujm7Gx7gRltLeRwDRIBMihcnRLLC6GFe\\\",\\\"expiry\\\":1645822470},\\\"HlSFMLF15PcIcrtHRu26UQ\\\":{\\\"token\\\":\\\"$2a$10$sQi7vIDcgxWhF7Mwrq4qEONBm/8u8SDy8QhfzoOuTnecrvh7BOOfi\\\",\\\"expiry\\\":1645824044}}\""], ["updated_at", "2022-02-11 21:20:44.727754"], ["id", 9]]
  [1m[35m (5.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
Completed 200 OK in 354ms (Views: 0.2ms | ActiveRecord: 11.8ms | Allocations: 9418)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 21:20:48 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player2@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mTeam Load (0.5ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mJoinRequest Load (1.2ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 AND "join_requests"."team_id" = $2 LIMIT $3[0m  [["player_id", 9], ["team_id", 3], ["LIMIT", 1]]
  ↳ app/models/join_request.rb:69:in `unique_request'
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
Completed 422 Unprocessable Entity in 182ms (Views: 0.3ms | ActiveRecord: 14.2ms | Allocations: 18553)


Started POST "/api/v1/auth" for 172.25.0.1 at 2022-02-11 21:21:04 +0000
Processing by DeviseTokenAuth::RegistrationsController#create as */*
  Parameters: {"email"=>"player3@derby.com", "phone_number"=>"01231231239", "password"=>"[FILTERED]", "name"=>"player3", "role"=>"player", "registration"=>{"email"=>"player3@derby.com", "phone_number"=>"01231231239", "password"=>"[FILTERED]", "name"=>"player3", "role"=>"player"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "player3@derby.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "01231231239"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "email", "phone_number", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "player3@derby.com"], ["encrypted_password", "$2a$12$p2dd7JhJ.uKGBixMqq91NOOAxFcxNXucLU2hMVhTOe6LRbjoWPL9i"], ["name", "player3"], ["email", "player3@derby.com"], ["phone_number", "01231231239"], ["created_at", "2022-02-11 21:21:04.631445"], ["updated_at", "2022-02-11 21:21:04.631445"]]
  [1m[35m (3.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "01231231239"], ["id", 10], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"MZnFw6Z4xueDKpRhak_CqA\\\":{\\\"token\\\":\\\"$2a$10$yZu2eciFDXq0gdD032moRuFT/mSXRhNF527vXwnX3K8yy6h3caTxK\\\",\\\"expiry\\\":1645824064}}\""], ["updated_at", "2022-02-11 21:21:04.726309"], ["id", 10]]
  [1m[35m (3.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
Completed 200 OK in 414ms (Views: 0.2ms | ActiveRecord: 12.3ms | Allocations: 15139)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 21:21:08 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player3@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mTeam Load (0.4ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mJoinRequest Load (0.5ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 AND "join_requests"."team_id" = $2 LIMIT $3[0m  [["player_id", 10], ["team_id", 3], ["LIMIT", 1]]
  ↳ app/models/join_request.rb:69:in `unique_request'
  [1m[36mJoinRequest Create (0.7ms)[0m  [1m[32mINSERT INTO "join_requests" ("player_id", "team_id", "message", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["player_id", 10], ["team_id", 3], ["message", "I want to join"], ["created_at", "2022-02-11 21:21:08.851802"], ["updated_at", "2022-02-11 21:21:08.851802"]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  Rendering api/v1/user_requests/create.json.jbuilder
  Rendered api/v1/users/_user.json.jbuilder (Duration: 0.2ms | Allocations: 52)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 3]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:3
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:5
  Rendered api/v1/users/_minimal.json.jbuilder (Duration: 0.1ms | Allocations: 30)
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."team_id" = $1[0m  [["team_id", 3]]
  ↳ app/views/api/v1/teams/_team.json.jbuilder:8
  Rendered collection of api/v1/users/_minimal.json.jbuilder [1 times] (Duration: 0.3ms | Allocations: 45)
  Rendered api/v1/teams/_team.json.jbuilder (Duration: 32.3ms | Allocations: 3245)
  Rendered api/v1/join_requests/_request.json.jbuilder (Duration: 38.2ms | Allocations: 3498)
  Rendered api/v1/user_requests/create.json.jbuilder (Duration: 42.1ms | Allocations: 3916)
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
Completed 200 OK in 195ms (Views: 46.1ms | ActiveRecord: 10.1ms | Allocations: 14386)


Started POST "/api/v1/requests" for 172.25.0.1 at 2022-02-11 21:21:12 +0000
Processing by Api::V1::UserRequestsController#create as */*
  Parameters: {"request"=>{"team_id"=>3, "message"=>"I want to join"}, "user_request"=>{"request"=>{"team_id"=>3, "message"=>"I want to join"}}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "player3@derby.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mTeam Load (0.4ms)[0m  [1m[34mSELECT "teams".* FROM "teams" WHERE "teams"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
  [1m[36mJoinRequest Load (0.4ms)[0m  [1m[34mSELECT "join_requests".* FROM "join_requests" WHERE "join_requests"."player_id" = $1 AND "join_requests"."team_id" = $2 LIMIT $3[0m  [["player_id", 10], ["team_id", 3], ["LIMIT", 1]]
  ↳ app/models/join_request.rb:69:in `unique_request'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/api/v1/user_requests_controller.rb:18:in `create'
Completed 422 Unprocessable Entity in 150ms (Views: 0.8ms | ActiveRecord: 2.7ms | Allocations: 7910)


  [1m[35m (3.7ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE DATABASE "derby_development" ENCODING = 'unicode'[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (2.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.6ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5018709196908116535)[0m
  [1m[35m (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateInvitations (20220212115929)
  [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (59.4ms)[0m  [1m[35mCREATE TABLE "invitations" ("id" bigserial primary key, "team_id" bigint NOT NULL, "player_id" bigint NOT NULL, "status" integer DEFAULT 0, "message" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_37fb5b9295"
FOREIGN KEY ("team_id")
  REFERENCES "teams" ("id")
, CONSTRAINT "fk_rails_667eae007f"
FOREIGN KEY ("player_id")
  REFERENCES "users" ("id")
)[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE  INDEX  "index_invitations_on_team_id" ON "invitations"  ("team_id")[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE  INDEX  "index_invitations_on_player_id" ON "invitations"  ("player_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (3.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220212115929"]]
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(5018709196908116535)[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
